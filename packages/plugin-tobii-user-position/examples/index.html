<!DOCTYPE html>
<html>
<head>
    <title>Tobii User Position Plugin Example</title>
    <script src="https://unpkg.com/jspsych@8.0.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-html-keyboard-response@2.0.0"></script>
    <script src="../../extension-tobii/dist/index.browser.min.js"></script>
    <script src="../dist/index.browser.min.js"></script>

    <link href="https://unpkg.com/jspsych@8.0.0/css/jspsych.css" rel="stylesheet" type="text/css" />
</head>
<body>
</body>
<script>
    // Initialize jsPsych with Tobii extension
    const jsPsych = initJsPsych({
        extensions: [
            {
                type: jsPsychExtensionTobii,
                params: {
                    connection: {
                        url: 'ws://localhost:8080',
                        autoConnect: true,
                    },
                },
            },
        ],
        on_finish: function() {
            jsPsych.data.displayData();
        }
    });

    // Create timeline
    const timeline = [];

    // Welcome screen
    timeline.push({
        type: jsPsychHtmlKeyboardResponse,
        stimulus: `
            <h1>User Position Plugin Demo</h1>
            <p>This demo shows different configurations of the user position plugin.</p>
            <p>Press any key to begin.</p>
        `,
    });

    // Example 1: Basic position check with manual continuation
    timeline.push({
        type: jsPsychHtmlKeyboardResponse,
        stimulus: `
            <h2>Example 1: Basic Position Check</h2>
            <p>Manual continuation when ready.</p>
            <p>Press any key to start.</p>
        `,
    });

    timeline.push({
        type: jsPsychTobiiUserPosition,
        message: 'Please position yourself so both indicators are green',
        duration: null,
        update_interval: 100,
        show_distance_feedback: true,
        show_position_feedback: true,
        button_text: 'Continue',
    });

    // Example 2: Timed position check
    timeline.push({
        type: jsPsychHtmlKeyboardResponse,
        stimulus: `
            <h2>Example 2: Timed Position Check</h2>
            <p>Automatically continues after 5 seconds.</p>
            <p>Press any key to start.</p>
        `,
    });

    timeline.push({
        type: jsPsychTobiiUserPosition,
        message: 'Checking your position...',
        duration: 5000,
        update_interval: 100,
        show_distance_feedback: true,
        show_position_feedback: true,
    });

    // Example 3: Required good position
    timeline.push({
        type: jsPsychHtmlKeyboardResponse,
        stimulus: `
            <h2>Example 3: Required Good Position</h2>
            <p>Continue button only enabled when position is good.</p>
            <p>Press any key to start.</p>
        `,
    });

    timeline.push({
        type: jsPsychTobiiUserPosition,
        message: 'Adjust your position until indicators are green',
        duration: null,
        update_interval: 100,
        show_distance_feedback: true,
        show_position_feedback: true,
        button_text: 'Position Good - Continue',
        require_good_position: true,
    });

    // Example 4: Position only (no distance feedback)
    timeline.push({
        type: jsPsychHtmlKeyboardResponse,
        stimulus: `
            <h2>Example 4: Position Feedback Only</h2>
            <p>Shows horizontal/vertical position but not distance.</p>
            <p>Press any key to start.</p>
        `,
    });

    timeline.push({
        type: jsPsychTobiiUserPosition,
        message: 'Center yourself horizontally and vertically',
        duration: null,
        update_interval: 100,
        show_distance_feedback: false,
        show_position_feedback: true,
        button_text: 'Continue',
    });

    // Example 5: Custom colors
    timeline.push({
        type: jsPsychHtmlKeyboardResponse,
        stimulus: `
            <h2>Example 5: Custom Colors</h2>
            <p>Custom color scheme.</p>
            <p>Press any key to start.</p>
        `,
    });

    timeline.push({
        type: jsPsychTobiiUserPosition,
        message: 'Custom colored position guide',
        duration: null,
        update_interval: 100,
        show_distance_feedback: true,
        show_position_feedback: true,
        button_text: 'Continue',
        background_color: '#1a1a1a',
        good_color: '#00ff00',
        fair_color: '#ffaa00',
        poor_color: '#ff0000',
        button_color: '#0088ff',
        button_hover_color: '#0066cc',
    });

    // Thank you
    timeline.push({
        type: jsPsychHtmlKeyboardResponse,
        stimulus: `
            <h2>Demo Complete</h2>
            <p>You've seen all the position plugin examples.</p>
            <p>Press any key to view the collected data.</p>
        `,
    });

    // Run experiment
    jsPsych.run(timeline);
</script>
</html>
